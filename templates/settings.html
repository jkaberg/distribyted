<!DOCTYPE html>

<head>
    {{template "header.html" "Settings"}}
</head>

<body class="header-fixed sidebar-fixed sidebar-dark header-light" id="body">
    <div class="wrapper">
        {{template "navbar.html" "settings"}}

        <div class="page-wrapper">
            <header class="main-header " id="header">
                <nav class="navbar navbar-expand-lg border-bottom">
                    <button class="btn btn-outline-secondary d-lg-none" type="button" data-bs-toggle="offcanvas" data-bs-target="#sidebarOffcanvas" aria-controls="sidebarOffcanvas" aria-label="Toggle navigation">
                        <i class="bi bi-list"></i>
                    </button>
                    <div class="ms-auto d-flex align-items-center" style="gap:16px;">
                        <div id="topbar-stats" style="display:flex; align-items:center; gap:16px;">
                            <div id="tb-cache-wrap" style="width:40px; height:40px;">
                                <canvas id="tb-cache"></canvas>
                            </div>
                            <div style="display:flex; align-items:center; gap:8px;">
                                <span class="text-muted" style="font-size:12px;">DL</span>
                                <span id="tb-dl" style="font-weight:500;">...</span>
                                <span class="text-muted" style="font-size:12px;">UL</span>
                                <span id="tb-ul" style="font-weight:500;">...</span>
                            </div>
                            <div style="display:flex; align-items:center; gap:8px;">
                                <span id="tb-ip" class="text-muted" style="font-size:12px;">IP: ...</span>
                                <span id="tb-conn" class="badge bg-secondary">...</span>
                            </div>
                        </div>
                    </div>
                </nav>
            </header>

            <div class="content-wrapper">
                <div class="content">
                    <div class="row">
                        <div class="col-12">
                            <div class="tab-content">
                                <div class="tab-pane fade show active" id="tab-general" role="tabpanel">
                                    <div class="card card-default mb-3">
                                        <div class="card-header card-header-border-bottom"><h2 class="h5 mb-0">Filesystem watcher</h2></div>
                                        <div class="card-body">
                                            <form id="watch-interval-form-settings" class="row gy-2 gx-2 align-items-center">
                                                <div class="col-auto"><label class="col-form-label">Debounce interval (seconds)</label></div>
                                                <div class="col-auto"><input type="number" id="watch-interval-settings" min="1" class="form-control" value="5"></div>
                                                <div class="col-auto"><button type="submit" class="btn btn-primary">Save</button></div>
                                            </form>
                                            <div class="text-muted small mt-2">How often we react to file changes in watched folders. Higher = fewer scans.</div>
                                        </div>
                                    </div>
                                    <div class="card card-default mb-3">
                                        <div class="card-header card-header-border-bottom"><h2 class="h5 mb-0">Bandwidth Limits</h2></div>
                                        <div class="card-body">
                                            <form id="limits-form" class="row gy-2 gx-3 align-items-center">
                                                <div class="col-auto"><label class="col-form-label">Download (Mbit/s)</label></div>
                                                <div class="col-auto"><input type="number" step="0.1" min="0" id="dl-mbit" class="form-control" placeholder="0 = unlimited"></div>
                                                <div class="col-auto"><label class="col-form-label">Upload (Mbit/s)</label></div>
                                                <div class="col-auto"><input type="number" step="0.1" min="0" id="ul-mbit" class="form-control" placeholder="0 = unlimited"></div>
                                                <div class="col-auto"><button type="submit" class="btn btn-primary">Save</button></div>
                                            </form>
                                            <div class="text-muted small mt-2">Applies global bandwidth limits. 0 means no limit.</div>
                                        </div>
                                    </div>
                                    <div class="card card-default">
                                        <div class="card-header card-header-border-bottom"><h2 class="h5 mb-0">qBittorrent-compatible API</h2></div>
                                        <div class="card-body">
                                            <form id="qbt-form" class="row gy-2 gx-2 align-items-center">
                                                <div class="col-auto form-check"><input type="checkbox" id="qbt-enabled" class="form-check-input"> <label class="form-check-label" for="qbt-enabled">Enable API</label></div>
                                                <div class="col-auto"><button type="submit" class="btn btn-primary">Save</button></div>
                                            </form>
                                            <div class="text-muted small mt-2">Expose a qBittorrent-compatible Web API for Radarr/Sonarr/Lidarr to talk to.</div>
                                        </div>
                                    </div>
                                </div>
                                <div class="tab-pane fade" id="tab-health" role="tabpanel">
                                    <div class="card card-default mb-3">
                                        <div class="card-header card-header-border-bottom"><h2 class="h5 mb-0">Health Monitor</h2></div>
                                        <div class="card-body">
                                            <form id="health-form" class="row gy-2 gx-3 align-items-center">
                                                <div class="col-auto form-check"><input type="checkbox" id="health-enabled" class="form-check-input"> <label class="form-check-label" for="health-enabled">Enabled</label></div>
                                                <div class="col-auto"><label class="col-form-label">Interval (min)</label></div>
                                                <div class="col-auto"><input type="number" min="60" id="health-interval" class="form-control" value="60"></div>
                                                <div class="col-auto"><label class="col-form-label">Grace (min)</label></div>
                                                <div class="col-auto"><input type="number" min="0" id="health-grace" class="form-control" value="30"></div>
                                                <div class="col-auto"><label class="col-form-label">Min seeders</label></div>
                                                <div class="col-auto"><input type="number" min="0" id="health-min-seeders" class="form-control" value="2"></div>
                                                <div class="col-auto"><label class="col-form-label">Good seeders</label></div>
                                                <div class="col-auto"><input type="number" min="0" id="health-good-seeders" class="form-control" value="5"></div>
                                                <div class="col-auto"><label class="col-form-label">Excellent seeders</label></div>
                                                <div class="col-auto"><input type="number" min="0" id="health-excellent-seeders" class="form-control" value="10"></div>
                                                <div class="col-12"><button type="submit" class="btn btn-primary">Save</button></div>
                                            </form>
                                            <div class="text-muted small mt-2">Checks torrent health by seeders/peers every interval; below thresholds are auto-failed and re-requested via Arr.</div>
                                            <hr/>
                                            <h5 class="mt-3">Arr Instances</h5>
                                            <div id="arr-list"></div>
                                            <button id="arr-add" class="btn btn-sm btn-secondary mt-2">Add Instance</button>
                                            <div class="text-muted small mt-2">Add one or more Radarr/Sonarr/Lidarr instances (Base URL + API Key). We detect categories from each to decide which routes they own.</div>
                                        </div>
                                    </div>
                                </div>
                                <div class="tab-pane fade" id="tab-network" role="tabpanel">
                                    <div class="card card-default mb-3">
                                        <div class="card-header card-header-border-bottom"><h2 class="h5 mb-0">HTTP Server</h2></div>
                                        <div class="card-body">
                                            <form id="http-form" class="row gy-2 gx-3 align-items-center">
                                                <div class="col-auto"><label class="col-form-label">IP</label></div>
                                                <div class="col-auto"><input type="text" id="http-ip" class="form-control" placeholder="0.0.0.0"></div>
                                                <div class="col-auto"><label class="col-form-label">Port</label></div>
                                                <div class="col-auto"><input type="number" min="1" id="http-port" class="form-control" placeholder="4444"></div>
                                                <div class="col-auto form-check"><input type="checkbox" id="http-httpfs" class="form-check-input"> <label class="form-check-label" for="http-httpfs">HTTPFS</label></div>
                                                <div class="col-auto"><button type="submit" class="btn btn-primary">Save</button></div>
                                            </form>
                                            <div class="text-muted small mt-2">Bind address and port for the web UI. HTTPFS serves files over HTTP.</div>
                                        </div>
                                    </div>
                                    <div class="card card-default">
                                        <div class="card-header card-header-border-bottom"><h2 class="h5 mb-0">WebDAV</h2></div>
                                        <div class="card-body">
                                            <form id="webdav-form" class="row gy-2 gx-3 align-items-center">
                                                <div class="col-auto"><label class="col-form-label">Port</label></div>
                                                <div class="col-auto"><input type="number" min="1" id="wd-port" class="form-control" placeholder="36911"></div>
                                                <div class="col-auto"><label class="col-form-label">User</label></div>
                                                <div class="col-auto"><input type="text" id="wd-user" class="form-control" placeholder="admin"></div>
                                                <div class="col-auto"><label class="col-form-label">Pass</label></div>
                                                <div class="col-auto"><input type="password" id="wd-pass" class="form-control" placeholder="admin"></div>
                                                <div class="col-auto"><button type="submit" class="btn btn-primary">Save</button></div>
                                            </form>
                                            <div class="text-muted small mt-2">WebDAV access to mounted torrents.</div>
                                        </div>
                                    </div>
                                </div>
                                <div class="tab-pane fade" id="tab-torrent" role="tabpanel">
                                    <div class="card card-default">
                                        <div class="card-header card-header-border-bottom"><h2 class="h5 mb-0">Torrent (Advanced)</h2></div>
                                        <div class="card-body">
                                            <form id="torrent-form" class="row gy-2 gx-3 align-items-center">
                                                <div class="col-12 col-md-auto"><label class="col-form-label">Add Timeout (s)</label><input type="number" min="1" id="tor-addto" class="form-control" placeholder="60"></div>
                                                <div class="col-12 col-md-auto"><label class="col-form-label">Read Timeout (s)</label><input type="number" min="1" id="tor-readto" class="form-control" placeholder="120"></div>
                                                <div class="col-12 col-md-auto form-check ms-2"><input type="checkbox" id="tor-continue" class="form-check-input"> <label class="form-check-label" for="tor-continue">Continue on Add Timeout</label></div>
                                                <div class="col-12 col-md-auto"><label class="col-form-label">Cache Size (MB)</label><input type="number" min="0" id="tor-cache" class="form-control" placeholder="2048"></div>
                                                <div class="col-12"><label class="col-form-label">Metadata Folder</label><input type="text" id="tor-meta" class="form-control" placeholder="/path" style="min-width:320px"></div>
                                                <div class="w-100 my-2"></div>
                                                <div class="col-auto form-check"><input type="checkbox" id="tor-noipv6" class="form-check-input"> <label class="form-check-label" for="tor-noipv6">Disable IPv6</label></div>
                                                <div class="col-auto form-check"><input type="checkbox" id="tor-notcp" class="form-check-input"> <label class="form-check-label" for="tor-notcp">Disable TCP</label></div>
                                                <div class="col-auto form-check"><input type="checkbox" id="tor-noutp" class="form-check-input"> <label class="form-check-label" for="tor-noutp">Disable UTP</label></div>
                                                <div class="col-12 col-md-auto"><label class="col-form-label">Public IP</label><input type="text" id="tor-ip" class="form-control" placeholder=""></div>
                                                <div class="col-12 col-md-auto"><label class="col-form-label">Listen Port</label><input type="number" min="0" id="tor-port" class="form-control" placeholder="0=auto"></div>
                                                <div class="w-100 my-2"></div>
                                                <div class="col-12 col-lg-6"><label class="col-form-label">Extra Trackers (one per line)</label><textarea id="tor-extra-trackers" class="form-control" rows="3" placeholder="udp://tracker.opentrackr.org:1337/announce"></textarea></div>
                                                <div class="col-12 col-lg-6"><label class="col-form-label">Extra Trackers URL</label><input type="text" id="tor-extra-trackers-url" class="form-control" placeholder="https://example.com/trackers.txt"></div>
                                                <div class="col-12 col-md-auto"><label class="col-form-label">Reader Pool Size</label><input type="number" min="1" id="tor-pool" class="form-control" placeholder="4"></div>
                                                <div class="col-12 col-md-auto"><label class="col-form-label">Readahead (MB)</label><input type="number" min="0" id="tor-readahead" class="form-control" placeholder="2"></div>
                                                <div class="col-12"><button type="submit" class="btn btn-primary">Save</button></div>
                                            </form>
                                            <div class="text-muted small mt-2">Advanced torrent client behavior and resource limits. Some changes may require restart.</div>
                                        </div>
                                    </div>
                                </div>
                                <div class="tab-pane fade" id="tab-filesystem" role="tabpanel">
                                    <div class="card card-default">
                                        <div class="card-header card-header-border-bottom"><h2 class="h5 mb-0">FUSE</h2></div>
                                        <div class="card-body">
                                            <form id="fuse-form" class="row gy-2 gx-3 align-items-center">
                                                <div class="col-auto form-check"><input type="checkbox" id="fuse-allow" class="form-check-input"> <label class="form-check-label" for="fuse-allow">Allow other</label></div>
                                                <div class="col-auto"><label class="col-form-label">Path</label></div>
                                                <div class="col-auto"><input type="text" id="fuse-path" class="form-control" style="min-width:320px" placeholder="/data/mount"></div>
                                                <div class="col-auto"><button type="submit" class="btn btn-primary">Save</button></div>
                                            </form>
                                            <div class="text-muted small mt-2">Mount point and permissions for the filesystem view.</div>
                                        </div>
                                    </div>
                                </div>
                                <div class="tab-pane fade" id="tab-logging" role="tabpanel">
                                    <div class="card card-default">
                                        <div class="card-header card-header-border-bottom"><h2 class="h5 mb-0">Logging</h2></div>
                                        <div class="card-body">
                                            <form id="log-form" class="row gy-2 gx-3 align-items-center">
                                                <div class="col-auto form-check"><input type="checkbox" id="log-debug" class="form-check-input"> <label class="form-check-label" for="log-debug">Debug</label></div>
                                                <div class="col-auto"><label class="col-form-label">Path</label></div>
                                                <div class="col-auto"><input type="text" id="log-path" class="form-control" style="min-width:320px"></div>
                                                <div class="col-auto"><label class="col-form-label">Max backups</label></div>
                                                <div class="col-auto"><input type="number" min="0" id="log-backups" class="form-control" placeholder="2"></div>
                                                <div class="col-auto"><label class="col-form-label">Max size (MB)</label></div>
                                                <div class="col-auto"><input type="number" min="1" id="log-size" class="form-control" placeholder="50"></div>
                                                <div class="col-auto"><label class="col-form-label">Max age (days)</label></div>
                                                <div class="col-auto"><input type="number" min="0" id="log-age" class="form-control" placeholder="0"></div>
                                                <div class="col-auto"><button type="submit" class="btn btn-primary">Save</button></div>
                                            </form>
                                            <div class="text-muted small mt-2">Log file rotation settings. Changes apply to new sessions.</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <footer class="footer mt-auto">
                    <div class="copyright bg-white"></div>
                </footer>
            </div>

            {{template "footer.html"}}
            <script src="assets/js/settings.js"></script>
        </div>
    </div>
</body>

</html>

